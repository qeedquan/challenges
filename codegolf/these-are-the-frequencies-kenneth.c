/*

The Challenge
Generate 1 sec of an 8 bit tone sampled at 256 samples per second. The tone will be made up of a number of sine waves. The frequency of each sine wave will be determined from the input data.

These are deep tones, too low for a human to perceive, but I've chosen 8 bit numbers here since it's code-golf.

The Input
You will receive an array (or a list) of (non-negative) 8 bit signed integer values (0-127), each number will represent a frequency. An empty list is allowed and numbers may appear more than once in the list. All input frequencies must be assumed to be equal in amplitude.

The Output
Your program or function must output an array (or list) of 8 bit signed integer values that represents the signal generated.

Some graphical examples follow, but the actual output of your program is to be a list of integers. Not a graph and not a stream of bytes.

Also, your output must be normalized. That is, it must fill the window of possible values from -128 to 127. In other words, if you calculate a signal and its [min,max] is [-64,63], then you must amplify (multiply) the entire signal ×2. A flat signal will be all zeros. There should be no DC component in any output signal (ie. the average value should be 0). Since most (practically all) generated signals will be symmetrical then most likely your normalized signal will never contain a -128.

https://i.sstatic.net/2qoQK.png

The actual expected output of these datasets are as follows:

[]                                    => [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]
[2]                                   => [0,6,12,18,24,30,36,42,48,54,59,65,70,75,80,85,89,94,98,102,105,108,112,114,117,119,121,123,124,125,126,126,127,126,126,125,124,123,121,119,117,114,112,108,105,102,98,94,89,85,80,75,70,65,59,54,48,42,36,30,24,18,12,6,0,-6,-12,-18,-24,-30,-36,-42,-48,-54,-59,-65,-70,-75,-80,-85,-89,-94,-98,-102,-105,-108,-112,-114,-117,-119,-121,-123,-124,-125,-126,-126,-127,-126,-126,-125,-124,-123,-121,-119,-117,-114,-112,-108,-105,-102,-98,-94,-89,-85,-80,-75,-70,-65,-59,-54,-48,-42,-36,-30,-24,-18,-12,-6,0,6,12,18,24,30,36,42,48,54,59,65,70,75,80,85,89,94,98,102,105,108,112,114,117,119,121,123,124,125,126,126,127,126,126,125,124,123,121,119,117,114,112,108,105,102,98,94,89,85,80,75,70,65,59,54,48,42,36,30,24,18,12,6,0,-6,-12,-18,-24,-30,-36,-42,-48,-54,-59,-65,-70,-75,-80,-85,-89,-94,-98,-102,-105,-108,-112,-114,-117,-119,-121,-123,-124,-125,-126,-126,-127,-126,-126,-125,-124,-123,-121,-119,-117,-114,-112,-108,-105,-102,-98,-94,-89,-85,-80,-75,-70,-65,-59,-54,-48,-42,-36,-30,-24,-18,-12,-6]
[1,3]                                 => [0,8,16,24,32,39,47,54,61,68,75,81,87,93,98,103,107,111,115,118,120,123,124,126,126,126,126,126,125,123,121,119,116,113,110,106,102,98,94,89,84,79,74,69,64,59,54,49,44,39,35,30,26,22,18,15,12,9,7,4,3,1,0,0,0,0,0,1,3,4,7,9,12,15,18,22,26,30,35,39,44,49,54,59,64,69,74,79,84,89,94,98,102,106,110,113,116,119,121,123,125,126,126,127,126,126,124,123,120,118,115,111,107,103,98,93,87,81,75,68,61,54,47,39,32,24,16,8,0,-8,-16,-24,-32,-39,-47,-54,-61,-68,-75,-81,-87,-93,-98,-103,-107,-111,-115,-118,-120,-123,-124,-126,-126,-127,-126,-126,-125,-123,-121,-119,-116,-113,-110,-106,-102,-98,-94,-89,-84,-79,-74,-69,-64,-59,-54,-49,-44,-39,-35,-30,-26,-22,-18,-15,-12,-9,-7,-4,-3,-1,0,0,0,0,0,-1,-3,-4,-7,-9,-12,-15,-18,-22,-26,-30,-35,-39,-44,-49,-54,-59,-64,-69,-74,-79,-84,-89,-94,-98,-102,-106,-110,-113,-116,-119,-121,-123,-125,-126,-126,-126,-126,-126,-124,-123,-120,-118,-115,-111,-107,-103,-98,-93,-87,-81,-75,-68,-61,-54,-47,-39,-32,-24,-16,-8]
[15,14,13,12,11,10,9,8,7,6,5,4,3,2,1] => [0,32,63,89,109,122,126,124,114,100,82,62,43,26,13,4,0,0,3,9,16,24,30,35,37,36,33,27,21,14,8,3,0,-1,0,2,6,10,15,18,21,21,21,18,15,10,6,2,0,-1,-1,0,1,5,8,11,13,15,15,14,11,8,5,2,0,-1,-2,-1,0,1,4,6,9,10,11,11,9,7,5,2,0,-1,-2,-3,-2,0,1,3,6,7,8,9,8,6,4,2,0,-1,-3,-3,-3,-2,0,1,3,5,6,7,7,6,4,2,0,-2,-3,-4,-4,-4,-2,0,1,3,4,5,5,5,4,2,0,-2,-4,-5,-5,-5,-4,-3,-1,0,2,4,4,4,3,2,0,-2,-4,-6,-7,-7,-6,-5,-3,-1,0,2,3,3,3,1,0,-2,-4,-6,-8,-9,-8,-7,-6,-3,-1,0,2,3,2,1,0,-2,-5,-7,-9,-11,-11,-10,-9,-6,-4,-1,0,1,2,1,0,-2,-5,-8,-11,-14,-15,-15,-13,-11,-8,-5,-1,0,1,1,0,-2,-6,-10,-15,-18,-21,-21,-21,-18,-15,-10,-6,-2,0,1,0,-3,-8,-14,-21,-27,-33,-36,-37,-35,-30,-24,-16,-9,-3,0,0,-4,-13,-26,-43,-62,-82,-100,-114,-124,-127,-122,-109,-89,-63,-32]
[3,5,7,11,13,17,23]                   => [0,47,88,115,126,123,107,86,65,48,38,35,36,38,38,35,29,21,14,12,14,22,32,40,45,43,34,20,3,-10,-19,-22,-17,-10,-2,0,-3,-14,-30,-48,-60,-64,-56,-36,-7,22,49,66,70,60,40,14,-11,-31,-42,-44,-38,-29,-20,-14,-12,-14,-19,-23,-25,-23,-19,-14,-12,-14,-20,-29,-38,-44,-42,-31,-11,14,40,60,70,66,49,22,-7,-36,-56,-64,-60,-48,-30,-14,-3,0,-2,-10,-17,-22,-19,-10,3,20,34,43,45,40,32,22,14,12,14,21,29,35,38,38,36,35,38,48,65,86,107,123,126,115,88,47,0,-47,-88,-115,-126,-123,-107,-86,-65,-48,-38,-35,-36,-38,-38,-35,-29,-21,-14,-12,-14,-22,-32,-40,-45,-43,-34,-20,-3,10,19,22,17,10,2,0,3,14,30,48,60,64,56,36,7,-22,-49,-66,-70,-60,-40,-14,11,31,42,44,38,29,20,14,12,14,19,23,25,23,19,14,12,14,20,29,38,44,42,31,11,-14,-40,-60,-70,-66,-49,-22,7,36,56,64,60,48,30,14,3,0,2,10,17,22,19,10,-3,-20,-34,-43,-45,-40,-32,-22,-14,-12,-14,-21,-29,-35,-38,-38,-36,-35,-38,-48,-65,-86,-107,-123,-127,-115,-88,-47]
[1,1,2,3,5,8,13,21,34]                => [0,52,88,99,90,75,68,73,84,92,88,74,60,56,67,87,104,104,85,55,30,25,43,73,101,112,105,85,66,57,58,59,51,34,14,4,15,46,87,118,127,112,84,60,50,56,68,73,64,45,27,18,23,32,36,24,1,-21,-28,-11,26,70,103,114,103,83,66,61,63,63,53,34,13,4,13,36,59,68,54,23,-8,-27,-24,-6,14,23,15,-2,-20,-28,-25,-19,-21,-34,-52,-62,-51,-17,31,77,103,104,88,68,57,60,69,74,67,49,32,24,31,45,54,47,23,-7,-29,-29,-6,26,55,64,54,32,12,1,0,-1,-12,-32,-54,-64,-55,-26,6,29,29,7,-23,-47,-54,-45,-31,-24,-32,-49,-67,-74,-69,-60,-57,-68,-88,-104,-103,-77,-31,17,51,62,52,34,21,19,25,28,20,2,-15,-23,-14,6,24,27,8,-23,-54,-68,-59,-36,-13,-4,-13,-34,-53,-63,-63,-61,-66,-83,-103,-114,-103,-70,-26,11,28,21,-1,-24,-36,-32,-23,-18,-27,-45,-64,-73,-68,-56,-50,-60,-84,-112,-126,-118,-87,-46,-15,-4,-14,-34,-51,-59,-58,-57,-66,-85,-105,-112,-101,-73,-43,-25,-30,-55,-85,-104,-104,-87,-67,-56,-60,-74,-88,-92,-84,-73,-68,-75,-90,-99,-88,-52]
Additional Rules
All component frequencies are to begin at 0° phase. Basically, that means that they should start at 0 proceed to +127 at 90°, 0 again at 180°, -127 at 270° and then back to 0 at 360°.

It is acceptable if your outputs are slightly different due to rounding, from the examples posted here. They should be normalized to fill (or nearly fill) the range of possible signed ints (-128..127).

The usual loopholes are prohibited.

This is code-golf, shortest code wins.

IMPORTANT!
Practically everybody has made the same mistake in this challenge. 128 is NOT a valid signed 8 bit integer. You should not have output that contains this number or any number over 128.

*/

#define _GNU_SOURCE
#include <assert.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <math.h>
#include <float.h>

#define nelem(x) (sizeof(x) / sizeof(x[0]))

void
waves(int out[256], int *freq, size_t len)
{
	double shapes[256];
	double peak, value;
	size_t i, j;

	memset(shapes, 0, sizeof(shapes));
	peak = -DBL_MAX;
	for (i = 0; i < 256; i++) {
		for (j = 0; j < len; j++) {
			shapes[i] += sin(freq[j] * i * M_PI / 128);
			peak = fmax(peak, shapes[i]);
		}
	}
	if (peak == 0)
		peak = 1;

	for (i = 0; i < 256; i++) {
		value = 127 * shapes[i] / peak;
		if (value < 0)
			value = ceil(value);
		else
			value = floor(value);
		out[i] = value;
	}
}

void
test(int *freq, size_t len, int expected[256])
{
	int out[256];
	size_t i;

	waves(out, freq, len);
	for (i = 0; i < 256; i++) {
		assert(abs(out[i] - expected[i]) <= 1);
	}
}

int
main()
{
	int freq_2[] = {2};
	int freq_3[] = {1, 3};
	int freq_4[] = {15, 14, 13, 12, 11, 10, 9, 8, 7, 6, 5, 4, 3, 2, 1};
	int freq_5[] = {3, 5, 7, 11, 13, 17, 23};
	int freq_6[] = {1, 1, 2, 3, 5, 8, 13, 21, 34};

	int expected_1[] = {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};
	int expected_2[] = {0, 6, 12, 18, 24, 30, 36, 42, 48, 54, 59, 65, 70, 75, 80, 85, 89, 94, 98, 102, 105, 108, 112, 114, 117, 119, 121, 123, 124, 125, 126, 126, 127, 126, 126, 125, 124, 123, 121, 119, 117, 114, 112, 108, 105, 102, 98, 94, 89, 85, 80, 75, 70, 65, 59, 54, 48, 42, 36, 30, 24, 18, 12, 6, 0, -6, -12, -18, -24, -30, -36, -42, -48, -54, -59, -65, -70, -75, -80, -85, -89, -94, -98, -102, -105, -108, -112, -114, -117, -119, -121, -123, -124, -125, -126, -126, -127, -126, -126, -125, -124, -123, -121, -119, -117, -114, -112, -108, -105, -102, -98, -94, -89, -85, -80, -75, -70, -65, -59, -54, -48, -42, -36, -30, -24, -18, -12, -6, 0, 6, 12, 18, 24, 30, 36, 42, 48, 54, 59, 65, 70, 75, 80, 85, 89, 94, 98, 102, 105, 108, 112, 114, 117, 119, 121, 123, 124, 125, 126, 126, 127, 126, 126, 125, 124, 123, 121, 119, 117, 114, 112, 108, 105, 102, 98, 94, 89, 85, 80, 75, 70, 65, 59, 54, 48, 42, 36, 30, 24, 18, 12, 6, 0, -6, -12, -18, -24, -30, -36, -42, -48, -54, -59, -65, -70, -75, -80, -85, -89, -94, -98, -102, -105, -108, -112, -114, -117, -119, -121, -123, -124, -125, -126, -126, -127, -126, -126, -125, -124, -123, -121, -119, -117, -114, -112, -108, -105, -102, -98, -94, -89, -85, -80, -75, -70, -65, -59, -54, -48, -42, -36, -30, -24, -18, -12, -6};
	int expected_3[] = {0, 8, 16, 24, 32, 39, 47, 54, 61, 68, 75, 81, 87, 93, 98, 103, 107, 111, 115, 118, 120, 123, 124, 126, 126, 126, 126, 126, 125, 123, 121, 119, 116, 113, 110, 106, 102, 98, 94, 89, 84, 79, 74, 69, 64, 59, 54, 49, 44, 39, 35, 30, 26, 22, 18, 15, 12, 9, 7, 4, 3, 1, 0, 0, 0, 0, 0, 1, 3, 4, 7, 9, 12, 15, 18, 22, 26, 30, 35, 39, 44, 49, 54, 59, 64, 69, 74, 79, 84, 89, 94, 98, 102, 106, 110, 113, 116, 119, 121, 123, 125, 126, 126, 127, 126, 126, 124, 123, 120, 118, 115, 111, 107, 103, 98, 93, 87, 81, 75, 68, 61, 54, 47, 39, 32, 24, 16, 8, 0, -8, -16, -24, -32, -39, -47, -54, -61, -68, -75, -81, -87, -93, -98, -103, -107, -111, -115, -118, -120, -123, -124, -126, -126, -127, -126, -126, -125, -123, -121, -119, -116, -113, -110, -106, -102, -98, -94, -89, -84, -79, -74, -69, -64, -59, -54, -49, -44, -39, -35, -30, -26, -22, -18, -15, -12, -9, -7, -4, -3, -1, 0, 0, 0, 0, 0, -1, -3, -4, -7, -9, -12, -15, -18, -22, -26, -30, -35, -39, -44, -49, -54, -59, -64, -69, -74, -79, -84, -89, -94, -98, -102, -106, -110, -113, -116, -119, -121, -123, -125, -126, -126, -126, -126, -126, -124, -123, -120, -118, -115, -111, -107, -103, -98, -93, -87, -81, -75, -68, -61, -54, -47, -39, -32, -24, -16, -8};
	int expected_4[] = {0, 32, 63, 89, 109, 122, 126, 124, 114, 100, 82, 62, 43, 26, 13, 4, 0, 0, 3, 9, 16, 24, 30, 35, 37, 36, 33, 27, 21, 14, 8, 3, 0, -1, 0, 2, 6, 10, 15, 18, 21, 21, 21, 18, 15, 10, 6, 2, 0, -1, -1, 0, 1, 5, 8, 11, 13, 15, 15, 14, 11, 8, 5, 2, 0, -1, -2, -1, 0, 1, 4, 6, 9, 10, 11, 11, 9, 7, 5, 2, 0, -1, -2, -3, -2, 0, 1, 3, 6, 7, 8, 9, 8, 6, 4, 2, 0, -1, -3, -3, -3, -2, 0, 1, 3, 5, 6, 7, 7, 6, 4, 2, 0, -2, -3, -4, -4, -4, -2, 0, 1, 3, 4, 5, 5, 5, 4, 2, 0, -2, -4, -5, -5, -5, -4, -3, -1, 0, 2, 4, 4, 4, 3, 2, 0, -2, -4, -6, -7, -7, -6, -5, -3, -1, 0, 2, 3, 3, 3, 1, 0, -2, -4, -6, -8, -9, -8, -7, -6, -3, -1, 0, 2, 3, 2, 1, 0, -2, -5, -7, -9, -11, -11, -10, -9, -6, -4, -1, 0, 1, 2, 1, 0, -2, -5, -8, -11, -14, -15, -15, -13, -11, -8, -5, -1, 0, 1, 1, 0, -2, -6, -10, -15, -18, -21, -21, -21, -18, -15, -10, -6, -2, 0, 1, 0, -3, -8, -14, -21, -27, -33, -36, -37, -35, -30, -24, -16, -9, -3, 0, 0, -4, -13, -26, -43, -62, -82, -100, -114, -124, -127, -122, -109, -89, -63, -32};
	int expected_5[] = {0, 47, 88, 115, 126, 123, 107, 86, 65, 48, 38, 35, 36, 38, 38, 35, 29, 21, 14, 12, 14, 22, 32, 40, 45, 43, 34, 20, 3, -10, -19, -22, -17, -10, -2, 0, -3, -14, -30, -48, -60, -64, -56, -36, -7, 22, 49, 66, 70, 60, 40, 14, -11, -31, -42, -44, -38, -29, -20, -14, -12, -14, -19, -23, -25, -23, -19, -14, -12, -14, -20, -29, -38, -44, -42, -31, -11, 14, 40, 60, 70, 66, 49, 22, -7, -36, -56, -64, -60, -48, -30, -14, -3, 0, -2, -10, -17, -22, -19, -10, 3, 20, 34, 43, 45, 40, 32, 22, 14, 12, 14, 21, 29, 35, 38, 38, 36, 35, 38, 48, 65, 86, 107, 123, 126, 115, 88, 47, 0, -47, -88, -115, -126, -123, -107, -86, -65, -48, -38, -35, -36, -38, -38, -35, -29, -21, -14, -12, -14, -22, -32, -40, -45, -43, -34, -20, -3, 10, 19, 22, 17, 10, 2, 0, 3, 14, 30, 48, 60, 64, 56, 36, 7, -22, -49, -66, -70, -60, -40, -14, 11, 31, 42, 44, 38, 29, 20, 14, 12, 14, 19, 23, 25, 23, 19, 14, 12, 14, 20, 29, 38, 44, 42, 31, 11, -14, -40, -60, -70, -66, -49, -22, 7, 36, 56, 64, 60, 48, 30, 14, 3, 0, 2, 10, 17, 22, 19, 10, -3, -20, -34, -43, -45, -40, -32, -22, -14, -12, -14, -21, -29, -35, -38, -38, -36, -35, -38, -48, -65, -86, -107, -123, -127, -115, -88, -47};
	int expected_6[] = {0, 52, 88, 99, 90, 75, 68, 73, 84, 92, 88, 74, 60, 56, 67, 87, 104, 104, 85, 55, 30, 25, 43, 73, 101, 112, 105, 85, 66, 57, 58, 59, 51, 34, 14, 4, 15, 46, 87, 118, 127, 112, 84, 60, 50, 56, 68, 73, 64, 45, 27, 18, 23, 32, 36, 24, 1, -21, -28, -11, 26, 70, 103, 114, 103, 83, 66, 61, 63, 63, 53, 34, 13, 4, 13, 36, 59, 68, 54, 23, -8, -27, -24, -6, 14, 23, 15, -2, -20, -28, -25, -19, -21, -34, -52, -62, -51, -17, 31, 77, 103, 104, 88, 68, 57, 60, 69, 74, 67, 49, 32, 24, 31, 45, 54, 47, 23, -7, -29, -29, -6, 26, 55, 64, 54, 32, 12, 1, 0, -1, -12, -32, -54, -64, -55, -26, 6, 29, 29, 7, -23, -47, -54, -45, -31, -24, -32, -49, -67, -74, -69, -60, -57, -68, -88, -104, -103, -77, -31, 17, 51, 62, 52, 34, 21, 19, 25, 28, 20, 2, -15, -23, -14, 6, 24, 27, 8, -23, -54, -68, -59, -36, -13, -4, -13, -34, -53, -63, -63, -61, -66, -83, -103, -114, -103, -70, -26, 11, 28, 21, -1, -24, -36, -32, -23, -18, -27, -45, -64, -73, -68, -56, -50, -60, -84, -112, -126, -118, -87, -46, -15, -4, -14, -34, -51, -59, -58, -57, -66, -85, -105, -112, -101, -73, -43, -25, -30, -55, -85, -104, -104, -87, -67, -56, -60, -74, -88, -92, -84, -73, -68, -75, -90, -99, -88, -52};

	test(NULL, 0, expected_1);
	test(freq_2, nelem(freq_2), expected_2);
	test(freq_3, nelem(freq_3), expected_3);
	test(freq_4, nelem(freq_4), expected_4);
	test(freq_5, nelem(freq_5), expected_5);
	test(freq_6, nelem(freq_6), expected_6);

	return 0;
}
